{"version":3,"sources":["ui.coffee"],"names":[],"mappings":"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","file":"ui.js","sourceRoot":"/source/","sourcesContent":["# 用到了 turbolinks\r\n# 事件加载参考\r\n# https://github.com/rails/turbolinks/#no-jquery-or-any-other-library\r\n\r\njQuery(document).on 'ready page:load', ->\r\n  console.debug 'loaded'\r\n\r\n# 点亮 navbar\r\njQuery(document).on 'ready page:load', ->\r\n  nav = jQuery('[data-nav]').data('nav')\r\n  jQuery(\".layout-footer a.item.#{nav}\").addClass('active')\r\n\r\n# 填充标题\r\njQuery(document).on 'ready page:load', ->\r\n  title = jQuery('[data-title]').data('title')\r\n  jQuery(\".layout-header .page\").text title\r\n\r\n# home 页页签\r\njQuery(document).delegate '.page-landing .filter a.item', 'click', ->\r\n  $item = jQuery(this)\r\n  $item.closest('.filter').find('a.item').removeClass('active')\r\n  $item.addClass('active')\r\n\r\n# back 按钮链接\r\njQuery(document).on 'ready page:load', ->\r\n  back_url = jQuery('[data-back]').data('back')\r\n  jQuery(\".layout-header .back\").attr 'href', back_url\r\n\r\n# 投票选项点击\r\njQuery(document).delegate '.topic-options .option', 'click', ->\r\n  jQuery(this).toggleClass 'active'\r\n\r\n# 表单页的各种事件\r\nclass TopicForm\r\n  constructor: (@$el)->\r\n    return if @$el.length is 0\r\n    @current_step = 1\r\n\r\n    @$url_textarea = @$el.find('textarea.url')\r\n    @$a_loadurl = @$el.find('a.loadurl')\r\n    @$infocard = @$el.find('.infocard')\r\n    @$loading = @$el.find('.loading')\r\n    @$loadsuccess = @$el.find('.loaded-success')\r\n\r\n    @bind_events()\r\n\r\n  bind_events: ->\r\n    @$el.delegate 'a.next:not(.disabled)', 'click', => @to_next()\r\n    @$el.delegate 'a.prev:not(.disabled)', 'click', => @to_prev()\r\n\r\n    @$url_textarea.on 'input', =>\r\n      if jQuery.trim(@$url_textarea.val()).length > 0\r\n        @$a_loadurl.removeClass('disabled')\r\n      else\r\n        @$a_loadurl.addClass('disabled')\r\n\r\n    @$a_loadurl.on 'click', =>\r\n      return if @$a_loadurl.hasClass('disabled')\r\n      @loadurl()\r\n\r\n    @$el.delegate 'a.additem', 'click', =>\r\n      $input = @$el.find('.item-inputs .ipt').last().clone().val('')\r\n      @$el.find('.item-inputs').append $input.hide().fadeIn(200)\r\n      @refresh_item_ipts()\r\n\r\n    that = this\r\n    @$el.delegate '.ipt a.delete', 'click', ->\r\n      return if jQuery(this).hasClass('disabled')\r\n      jQuery(this).closest('.ipt').remove()\r\n      that.refresh_item_ipts()\r\n\r\n  refresh_item_ipts: ->\r\n    @$el.find('.item-inputs input').each (idx, i)->\r\n      jQuery(this).attr('placeholder', \"选项 #{idx + 1}\")\r\n    if @$el.find('.item-inputs input').length < 3\r\n      @$el.find('.item-inputs .ipt a.delete').addClass('disabled')\r\n    else\r\n      @$el.find('.item-inputs .ipt a.delete').removeClass('disabled')\r\n\r\n  loadurl: ->\r\n    @$a_loadurl.hide()\r\n    @$loading.show()\r\n    @$el.find('a.next.skip').addClass('disabled')\r\n    @$loading.find('.p')\r\n      .css\r\n        'width': 0\r\n      .animate\r\n        'width': '100%'\r\n      , 5000, =>\r\n        @$infocard.show(200)\r\n        @$loading.hide()\r\n        @$loadsuccess.show()\r\n        @$el.find('a.next.skip').hide()\r\n        @$el.find('a.next.urldone').show()\r\n\r\n\r\n\r\n  to_next: ->\r\n    to_step = @current_step + 1\r\n    $current_link = @$el.find(\".steps .step[data-step=#{@current_step}]\")\r\n    $to_link = @$el.find(\".steps .step[data-step=#{to_step}]\")\r\n\r\n    if $to_link.length > 0\r\n      $current_part = @$el.find(\".part[data-step=#{@current_step}]\")\r\n      $to_part = @$el.find(\".part[data-step=#{to_step}]\")\r\n\r\n      $current_part.fadeOut(200)\r\n      $to_part.fadeIn(200)\r\n      $current_link.removeClass('active').addClass('done')\r\n      $to_link.addClass('active')\r\n\r\n      @current_step = to_step\r\n\r\n  to_prev: ->\r\n    to_step = @current_step - 1\r\n    $current_link = @$el.find(\".steps .step[data-step=#{@current_step}]\")\r\n    $to_link = @$el.find(\".steps .step[data-step=#{to_step}]\")\r\n\r\n    if $to_link.length > 0\r\n      $current_part = @$el.find(\".part[data-step=#{@current_step}]\")\r\n      $to_part = @$el.find(\".part[data-step=#{to_step}]\")\r\n\r\n      $current_part.fadeOut(200)\r\n      $to_part.fadeIn(200)\r\n      $current_link.removeClass('active')\r\n      $to_link.addClass('active').removeClass('done')\r\n\r\n      @current_step = to_step\r\n\r\n\r\njQuery(document).on 'ready page:load', ->\r\n  new TopicForm jQuery('.page-new-topic')"]}