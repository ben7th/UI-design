{"version":3,"sources":["ui.coffee"],"names":[],"mappings":"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","file":"ui.js","sourceRoot":"/source/","sourcesContent":["# 用到了 turbolinks\r\n# 事件加载参考\r\n# https://github.com/rails/turbolinks/#no-jquery-or-any-other-library\r\n\r\n# 事件检查\r\njQuery(document).on 'ready page:load', ->\r\n  console.debug 'loaded'\r\n\r\n# 点亮 footer navbar\r\njQuery(document).on 'ready page:load', ->\r\n  nav = jQuery('[data-nav]').data('nav')\r\n  jQuery(\".layout-footer a.item.#{nav}\").addClass('active')\r\n\r\n# 填充标题\r\njQuery(document).on 'ready page:load', ->\r\n  title = jQuery('[data-title]').data('title')\r\n  jQuery(\".layout-header .page\").text title\r\n\r\n# home 页页签\r\njQuery(document).on 'click', '.page-landing .filter a.item', ->\r\n  $item = jQuery(this)\r\n  $item.closest('.filter').find('a.item').removeClass('active')\r\n  $item.addClass('active')\r\n\r\n# back 按钮链接\r\njQuery(document).on 'ready page:load', ->\r\n  back_url = jQuery('[data-back]').data('back')\r\n  jQuery(\".layout-header .back\").attr 'href', back_url\r\n\r\n# 投票选项点击\r\njQuery(document).on 'click', '.topic-options .option', ->\r\n  jQuery(this).toggleClass 'active'\r\n\r\n# ----------------------------\r\n\r\n# 导航上的“新增”按钮\r\njQuery(document).on 'click', '.footer-nav .item.new', ->\r\n  jQuery('.footer-nav').addClass('new-topic-type-select')\r\n  jQuery('.float-new-type-select').addClass('show')\r\n\r\njQuery(document).on 'click', '.footer-nav a.cancel-new', ->\r\n  jQuery('.footer-nav').removeClass('new-topic-type-select')\r\n  jQuery('.float-new-type-select').removeClass('show')\r\n\r\n# ---------------------------------\r\n\r\nis_field_empty = ($field)->\r\n  return jQuery.trim($field.val()).length is 0\r\n\r\n# 表单页的各种事件\r\nclass TopicForm\r\n  constructor: (@$el)->\r\n    return if @$el.length is 0\r\n    @current_step = 1\r\n\r\n    @$url_textarea = @$el.find('textarea.url')\r\n    @$a_loadurl = @$el.find('a.loadurl')\r\n    @$infocard = @$el.find('.infocard')\r\n    @$loading = @$el.find('.loading')\r\n    @$loadsuccess = @$el.find('.loaded-success')\r\n\r\n    @$tdesc_textarea = @$el.find('textarea.tdesc')\r\n\r\n    @bind_events()\r\n\r\n  bind_events: ->\r\n    # 上一步，下一步，完成\r\n    @$el.on 'click', 'a.next:not(.disabled)', => @to_next()\r\n    @$el.on 'click', 'a.prev:not(.disabled)', => @to_prev()\r\n    @$el.on 'click', 'a.done.disabled', (evt)->\r\n      evt.preventDefault()\r\n\r\n    that = this\r\n\r\n    # 增加选项\r\n    @$el.on 'click', 'a.additem', =>\r\n      $ipt = @$el.find('.item-inputs .ipt').last().clone()\r\n      $ipt.find('input').val('')\r\n      $ipt.hide().fadeIn(200)\r\n      @$el.find('.item-inputs').append $ipt\r\n      @refresh_item_ipts()\r\n\r\n    # 移除选项\r\n    @$el.on 'click', '.ipt a.delete:not(.disabled)', ->\r\n      jQuery(this).closest('.ipt').remove()\r\n      that.refresh_item_ipts()\r\n\r\n    # 当输入选项时进行校验\r\n    @$el.find('.item-inputs').on 'input', =>\r\n      @refresh_item_ipts()\r\n\r\n    # ----------\r\n\r\n    # 输入网址后才点亮读取按钮\r\n    @$url_textarea.on 'input' , =>\r\n      if is_field_empty @$url_textarea\r\n        @$a_loadurl.addClass('disabled')\r\n      else\r\n        @$a_loadurl.removeClass('disabled')\r\n\r\n    # 读取网址\r\n    @$a_loadurl.on 'click', =>\r\n      return if @$a_loadurl.hasClass('disabled')\r\n      @loadurl()\r\n\r\n    # 如果成功读取了网址信息, 就把这些信息放到下一步表单中\r\n    @$el.on 'click', 'a.next.urldone:not(.disabled)', =>\r\n      @$el.find('.part.tdesc')\r\n        .find('.infocard').remove().end()\r\n        .prepend @$infocard.clone()\r\n\r\n    # -----------\r\n\r\n    # 议题描述校验\r\n    @$tdesc_textarea.on 'input' , =>\r\n      $a_next = @$tdesc_textarea.closest('.part').find('a.next')\r\n      if is_field_empty @$tdesc_textarea\r\n        $a_next.addClass('disabled')\r\n      else\r\n        $a_next.removeClass('disabled')\r\n\r\n\r\n  refresh_item_ipts: ->\r\n    count = 0\r\n    @$el.find('.item-inputs input').each (idx, i)->\r\n      jQuery(this).attr('placeholder', \"选项 #{idx + 1}\")\r\n      if jQuery.trim(jQuery(this).val()).length > 0\r\n        count += 1\r\n      if count >= 2\r\n        jQuery(this).closest('.part').find('a.done').removeClass('disabled')\r\n      else\r\n        jQuery(this).closest('.part').find('a.done').addClass('disabled')\r\n\r\n    if @$el.find('.item-inputs input').length < 3\r\n      @$el.find('.item-inputs .ipt a.delete').addClass('disabled')\r\n    else\r\n      @$el.find('.item-inputs .ipt a.delete').removeClass('disabled')\r\n\r\n  loadurl: ->\r\n    @$a_loadurl.hide()\r\n    @$loading.show()\r\n    @$el.find('a.next.skip').addClass('disabled')\r\n    @$loading.find('.p')\r\n      .css\r\n        'width': 0\r\n      .animate\r\n        'width': '100%'\r\n      , 3000, =>\r\n        @$infocard.fadeIn(200)\r\n        @$loading.hide()\r\n        @$loadsuccess.show()\r\n        @$el.find('a.next.skip').hide()\r\n        @$el.find('a.next.urldone').show()\r\n        @$url_textarea.attr('disabled', true)\r\n\r\n  to_next: ->\r\n    to_step = @current_step + 1\r\n    $current_link = @$el.find(\".steps .step[data-step=#{@current_step}]\")\r\n    $to_link = @$el.find(\".steps .step[data-step=#{to_step}]\")\r\n\r\n    if $to_link.length > 0\r\n      $current_part = @$el.find(\".part[data-step=#{@current_step}]\")\r\n      $to_part = @$el.find(\".part[data-step=#{to_step}]\")\r\n\r\n      $current_part.fadeOut(200)\r\n      $to_part.fadeIn(200)\r\n      $current_link.removeClass('active').addClass('done')\r\n      $to_link.addClass('active')\r\n\r\n      @current_step = to_step\r\n\r\n  to_prev: ->\r\n    to_step = @current_step - 1\r\n    $current_link = @$el.find(\".steps .step[data-step=#{@current_step}]\")\r\n    $to_link = @$el.find(\".steps .step[data-step=#{to_step}]\")\r\n\r\n    if $to_link.length > 0\r\n      $current_part = @$el.find(\".part[data-step=#{@current_step}]\")\r\n      $to_part = @$el.find(\".part[data-step=#{to_step}]\")\r\n\r\n      $current_part.fadeOut(200)\r\n      $to_part.fadeIn(200)\r\n      $current_link.removeClass('active')\r\n      $to_link.addClass('active').removeClass('done')\r\n\r\n      @current_step = to_step\r\n\r\n\r\njQuery(document).on 'ready page:load', ->\r\n  new TopicForm jQuery('.page-new-topic')"]}